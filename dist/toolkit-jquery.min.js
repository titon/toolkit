/*! Titon Toolkit v1.5.1 | BSD-3 License | titon.io */
!function(a,b){"use strict";function c(a,b,c){c===!0?c="true":c===!1&&(c="false"),a.setAttribute("aria-"+b,c)}var d={},e=function(){for(var a="transition WebkitTransition MozTransition OTransition msTransition".split(" "),b=document.createElement("div").style,c=0;c<a.length;c++)if(a[c]in b)return a[c];return!1}(),f={version:"1.5.1",build:"hyar4lst",vendor:"",aria:!0,messages:{loading:"Loading...",error:"An error has occurred!"},hasTransition:e,transitionEnd:function(){var a={WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd otransitionend"};return a[e]||"transitionend"}(),isTouch:!!("ontouchstart"in a||a.DocumentTouch&&document instanceof DocumentTouch),isRetina:a.devicePixelRatio>1,create:function(a,c,e){var f=a;b.fn[f]&&(f="toolkit"+f.charAt(0).toUpperCase()+f.slice(1)),b.fn[f]=e?function(){var e=d[a+"."+this.selector]=c.apply(this,arguments);return this.each(function(){b(this).addData("toolkit."+a,e)})}:function(){var d=arguments;return this.each(function(){b(this).addData("toolkit."+a,c.apply(this,d))})}},Class:function(){}};a.Toolkit=f;var g=f.vendor;f.Class.extend=function(a,c,d){var e=function(){for(var b in this)"function"==typeof this[b]&&(this[b]=this[b].bind(this));this.uid=e.count+=1,a.apply(this,arguments)};return b.extend(e.prototype,this.prototype,c||{}),e.options=b.extend(!0,{},this.options||{},d||{}),e.extend=this.extend,e.count=0,e.prototype.constructor=a,e},b.fn.toolkit=function(a,c,e){var f=this.selector,g=this.data("toolkit."+a);return!g&&d[a+"."+f]&&(g=d[a+"."+f]),g?(c&&g[c]&&g[c].apply(g,b.makeArray(e)),g):null},b.fn.reveal=function(){return this.removeClass("hide").addClass("show").aria("hidden",!1)},b.fn.conceal=function(){return this.removeClass("show").addClass("hide").aria("hidden",!0)},b.fn.aria=function(a,d){return f.aria?("toggled"===a&&(a={expanded:d,selected:d},d=null),b.access(this,c,a,d,arguments.length>1)):this},b.fn.addData=function(a,b){var c=this.data(a);return c?c:("function"==typeof b&&(b=b.call(this)),this.data(a,b),b)},b.fn.positionTo=function(c,d,e,f){if(!c)return this;var g,h=c,i=e||{left:0,top:0},j=0,k=0,l=this.outerHeight(!0),m=this.outerWidth(!0),n=b(a),o=n.width(),p=n.height(),q=n.scrollTop();d.preventDefault?g={left:d.pageX,top:d.pageY}:(g=d.offset(),j=d.outerHeight(),k=d.outerWidth()),i.left+=g.left,i.top+=g.top,g.top-l-q<0?h=h.replace("top","bottom"):g.top+j+l>p&&(h=h.replace("bottom","top")),g.left-m<0?h=h.replace("left","right"):g.left+k+m>o&&(h=h.replace("right","left")),c!==h&&(this.removeClass(c).addClass(h).data("new-position",h),c=h);var r=c.split("-"),s={y:r[0],x:r[1]};return"top"===s.y?i.top-=l:"bottom"===s.y?i.top+=j:"center"===s.y&&(i.top-=Math.round(l/2-j/2)),"left"===s.x?i.left-=m:"right"===s.x?i.left+=k:"center"===s.x&&(i.left-=Math.round(m/2-k/2)),f&&("center"===s.y&&("left"===s.x?i.left-=15:"right"===s.x&&(i.left+=15)),"center"===s.x&&("top"===s.y?i.top-=10:"bottom"===s.y&&(i.top+=10))),this.css(i)},b.fn.transitionend=function(a,b){var c=f.transitionEnd;if(arguments.length>0){this.one(c,null,a,b);var d=this.css("transition-duration");("0s"===d||"undefined"==typeof d)&&this.trigger(c)}else this.trigger(c);return this},b.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments;clearTimeout(d),d=setTimeout(function(){d=null,c||a.apply(e,f)},b||150),c&&!d&&a.apply(e,f)}},b.throttle=function(a,b){if(!b)return a;var c=!1;return function(){var d=this,e=arguments;c||(c=!0,setTimeout(function(){a.apply(d,e),c=!1},b))}},b.expr[":"].shown=function(a){return"hidden"!==b(a).css("visibility")},b.bound=function(a,b,c){return c=c||0,a>=b?a=0:c>a&&(a=b-1),a},b.cookie||(b.cookie=function(a,c,d){if(d=b.extend({expires:null,path:"/",domain:"",secure:!1},d),"undefined"!=typeof c){if("number"==typeof d.expires){var e=new Date;e.setTime(e.getTime()+24*d.expires*60*60*1e3),d.expires=e.toUTCString()}return document.cookie=[a+"="+encodeURIComponent(c),d.expires?"; expires="+d.expires:"",d.path?"; path="+d.path:"",d.domain?"; domain="+d.domain:"",d.secure?"; secure":""].join("")}return c=document.cookie.match("(?:^|;)\\s*"+a.replace(/[\-\.\+\*]/g,"\\$&")+"=([^;]*)"),c&&c.length?decodeURIComponent(c[1]):null},b.removeCookie=function(a,c){return c=c||{},c.expires=-1,b.cookie(a,"",c)}),b.event.special.clickout||(b.event.special.clickout=function(){var a=[];return b(document).on("click.toolkit.out",function(c){if(a.length){var d=!0,e=b(document),f=b(c.target);b.each(a,function(a,g){var h=b(g);return(d="string"===b.type(g)?!f.is(g)&&!h.has(c.target).length:!h.is(c.target)&&!h.has(c.target).length)?void(e=e.add(h)):!1}),d&&e.trigger("clickout",[c.target])}}),{add:function(c){var d=this;this===document&&(d=c.selector),-1===b.inArray(d,a)&&a.push(d)},remove:function(c){var d=this;this===document&&(d=c.selector),a=b.grep(a,function(a){return a!==d})}}}()),b.event.special.swipe||(b.event.special.swipe=function(){function a(a){var b=a.originalEvent.changedTouches?a.originalEvent.changedTouches[0]:a;return{time:(new Date).getTime(),x:b.pageX,y:b.pageY}}function c(a,c,d,e){if(a&&c){var f,g=b.event.special.swipe,h=c.x-a.x,i=c.y-a.y;if(c.time-a.time<=g.duration){if(j(h)>=g.distance&&j(i)<=g.restraint)f=0>h?"left":"right";else{if(!(j(i)>=g.distance&&j(h)<=g.restraint))return;f=0>i?"up":"down"}var k={target:e,swipestart:a,swipestop:c};d.trigger(b.Event("swipe",k)).trigger(b.Event("swipe"+f,k))}}}var d=f.isTouch,e=d?"touchstart":"mousedown",g=d?"touchmove":"mousemove",h=d?"touchend":"mouseup",i=!1,j=Math.abs;return{duration:1e3,distance:50,restraint:75,setup:function(){function f(b){var c=a(b);j(l.x-c.x)>j(l.y-c.y)&&b.preventDefault()}function k(){l=m=null,i=!1,n.off(g,f)}var l,m,n=b(this);n.on(e,function(b){d||"img"!==b.target.tagName.toLowerCase()||b.preventDefault(),i||(l=a(b),m=b.target,i=!0,d&&n.on(g,f))}),n.on(h,function(b){c(l,a(b),n,m),k()}),n.on("touchcancel",k)},teardown:function(){b(this).off(e).off(g).off(h).off("touchcancel")}}}(),b.each("swipe swipeleft swiperight swipeup swipedown".split(" "),function(a,c){"swipe"!==c&&(b.event.special[c]={setup:function(){b(this).on("swipe",b.noop)},teardown:function(){b(this).off("swipe")}})})),Function.prototype.bind||(Function.prototype.bind=function(a){var b=this,c=[].slice.call(arguments,1),d=function(){},e=function(){return b.apply(this instanceof d&&a?this:a,c.concat([].slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),f.Component=f.Class.extend(function(){},{component:"Component",version:"1.4.1",enabled:!1,events:{},cache:{},runtime:{},createElement:function(){var a,c=this.options;if(c.templateFrom&&(a=b(c.templateFrom)),a&&a.length||!c.template||(a=b(c.template),a.length&&a.conceal().appendTo("body")),!a)throw new Error("Failed to create template element");return c.className&&a.addClass(c.className),c.animation&&a.addClass(c.animation),this.created=!0,a.attr("id",this.id())},bindEvents:function(c){var d,e,f,h,i,j=this,k=this.options,l=b(a),m=b(document);b.each(this.events,function(a,n){i=b.isArray(n)?n:[n],a=a.replace("{mode}",k.mode),a=a.replace("{selector}",j.nodes?j.nodes.selector:""),e=a.split(" "),d=e.shift(),f=e.shift(),h=e.join(" ").replace("@",g),j[f]?f=j[f]:"window"===f?f=l:"document"===f&&(f=m),b.each(i,function(a,e){b.isFunction(e)||(e=j[e]),"ready"===d?m.ready(e):h?b(f)[c](d,h,e):b(f)[c](d,e)})})},destroy:function(){this.fireEvent("destroy"),this.hide&&this.hide(),this.doDestroy&&this.doDestroy(),this.disable(),this.created&&this.element.remove();var a=this._keyName();this.nodes?(this.nodes.removeData("toolkit."+a),delete d[a+"."+this.nodes.selector]):this.element&&this.element.removeData("toolkit."+a)},disable:function(){this.enabled&&this.bindEvents("off"),this.enabled=!1},enable:function(){this.enabled||this.bindEvents("on"),this.enabled=!0},fireEvent:function(a,c){b.isArray(c)||(c=[c]);var d="on"+a.charAt(0).toUpperCase()+a.slice(1);this.options[d]&&this.options[d].apply(this,c||[]);var e=this.element,f=this.node,g=jQuery.Event(a+".toolkit."+this._keyName());g.context=this,e&&e.length&&e.trigger(g,c||[]),f&&f.length&&f.trigger(g,c||[])},id:function(){var a=b.makeArray(arguments);return a.unshift("toolkit",this._cssClass(),this.uid),a.join("-")},inheritOptions:function(a,c){var d,e,f={};for(d in a)"context"!==d&&"template"!==d&&(e=c.data((this._keyName()+"-"+d).toLowerCase()),"undefined"!==b.type(e)&&(f[d]=e));return b.extend(!0,{},a,f)},initialize:function(){this.enable(),this.fireEvent("init")},process:function(b){if(this.hide(),b.callback){for(var c=b.callback.split("."),d=a,e=d,f=0;f<c.length;f++)e=d,d=d[c[f]];d.call(e,b)}this.fireEvent("process",b)},readOption:function(a,c){var d=a.data((this._keyName()+"-"+c).toLowerCase());return"undefined"===b.type(d)&&(d=this.options[c]),d},readValue:function(a,c){return c?(a=b(a),"function"===b.type(c)?c.call(this,a):a.attr(c)):null},requestData:function(a,c,d,e){var g=a.url||a,h=b.extend({},{url:g,type:"GET",context:this,beforeSend:c||function(){this.cache[g]=!0,this.element.addClass("is-loading").aria("busy",!0)}},a);"object"===b.type(this.options.ajax)&&(h=b.extend({},this.options.ajax,h));var i="GET"===h.type.toUpperCase()&&this.options.cache;return b.ajax(h).done(d||function(a,b,c){this.element.removeClass("is-loading").aria("busy",!1),c.getResponseHeader("Content-Type").indexOf("text/html")>=0?(i?this.cache[g]=a:delete this.cache[g],this.position(a)):(delete this.cache[g],this.process(a))}).fail(e||function(){delete this.cache[g],this.element.removeClass("is-loading").addClass("has-failed").aria("busy",!1),this.position(f.messages.error)})},setOptions:function(c,d){var e=b.extend(!0,{},f[this.component].options,c||{});return d&&(e=this.inheritOptions(e,d)),e.responsive&&a.matchMedia&&b.each(e.responsive,function(a,c){return matchMedia(c.breakpoint).matches?(b.extend(e,c),!1):void 0}),e.mode&&"hover"===e.mode&&(e.mode=f.isTouch?"click":"mouseenter"),e},_cssClass:function(){return this.cssClass?this.cssClass:this.cssClass=this.component.replace(/[A-Z]/g,function(a){return"-"+a.charAt(0).toLowerCase()}).slice(1)},_keyName:function(){if(this.keyName)return this.keyName;var a=this.component;return this.keyName=a.charAt(0).toLowerCase()+a.slice(1)}},{cache:!0,context:null,className:"",template:"",templateFrom:""}),f.Accordion=f.Component.extend(function(a,c){var d=this;this.component="Accordion",this.version="1.4.0",this.element=a=b(a).attr("role","tablist"),this.options=c=this.setOptions(c,a),this.headers=a.find("."+g+"accordion-header").each(function(a){b(this).data("index",a).attr({role:"tab",id:d.id("header",a)}).aria({controls:d.id("section",a),selected:!1,expanded:!1})}),this.sections=a.find("."+g+"accordion-section").each(function(a){b(this).data("height",b(this).height()).attr({role:"tabpanel",id:d.id("section",a)}).aria("labelledby",d.id("header",a)).conceal()}),this.index=0,this.node=null,this.events={"{mode} element .@accordion-header":"onShow"},this.initialize(),this.jump(c.defaultIndex)},{doDestroy:function(){this.headers.parent().removeClass("is-active"),this.sections.removeAttr("style").reveal()},jump:function(a){a=b.bound(a,this.headers.length),this.fireEvent("jump",a),this.show(this.headers[a])},show:function(a){a=b(a);var c=this.options,d=a.parent(),e=a.next(),f=a.data("index"),g=parseInt(e.data("height"),10),h=this.node&&this.node.is(a);if("click"===c.mode&&(c.multiple||c.collapsible&&h))e.is(":shown")&&this.node?(e.css("max-height",0).conceal(),d.removeClass("is-active"),a.aria("toggled",!1)):(e.css("max-height",g).reveal(),d.addClass("is-active"),a.aria("toggled",!0));else{if(h)return;this.sections.css("max-height",0).conceal(),e.css("max-height",g).reveal(),this.headers.aria("toggled",!1),a.aria("toggled",!0),this.element.children("li").removeClass("is-active"),d.addClass("is-active")}this.index=f,this.node=a,this.fireEvent("show",[e,a,f])},onShow:function(a){a.preventDefault(),this.show(a.currentTarget)}},{mode:"click",defaultIndex:0,multiple:!1,collapsible:!1}),f.create("accordion",function(a){return new f.Accordion(this,a)}),f.Blackout=f.Component.extend(function(a){this.component="Blackout",this.version="1.4.0",this.options=a=this.setOptions(a),this.element=this.createElement(),this.count=0;var c,d="bubble-spinner"===a.loader?8:a.waveCount,e=b("<div/>").addClass(g+"loader").addClass(a.loader).appendTo(this.element),h="";for(c=0;d>c;c++)h+="<span></span>";"bubble-spinner"===a.loader?b("<div/>").addClass(g+"loader-spinner").html(h).appendTo(e):e.html(h),this.loader=e,this.message=b("<div/>").addClass(g+"loader-message").html(f.messages.loading).appendTo(e),this.initialize()},{hide:function(){var a=this.count-1;0>=a?(this.count=0,this.element.conceal(),this.hideLoader()):this.count=a,this.fireEvent("hide",0>=a)},hideLoader:function(){this.loader.conceal(),this.fireEvent("hideLoader")},show:function(){var a=!1;this.count++,1===this.count&&(this.element.reveal(),a=!0),this.showLoader(),this.fireEvent("show",a)},showLoader:function(){this.loader.reveal(),this.fireEvent("showLoader")}},{loader:"bar-wave",waveCount:5,template:'<div class="'+g+'blackout"></div>',templateFrom:"#toolkit-blackout-1"});var h=null;f.Blackout.factory=function(a){return h?h:h=new f.Blackout(a)},f.Carousel=f.Component.extend(function(a,c){var d,e=this;this.component="Carousel",this.version="1.5.0",this.element=a=b(a),this.options=c=this.setOptions(c,a),a.aria("live",c.autoCycle?"assertive":"off").addClass(c.animation),this.container=a.find("."+g+"carousel-items ul").addClass("no-transition"),this.items=d=this.container.find("li").each(function(a){b(this).attr({role:"tabpanel",id:e.id("item",a)}).data("carousel-index",a).aria("hidden",a>0)}),this.tabs=a.find("."+g+"carousel-tabs").attr("role","tablist").find("a").each(function(a){b(this).data("carousel-index",a).attr({role:"tab",id:e.id("tab",a)}).aria({controls:e.id("item",a),selected:!1,expanded:!1})}),this.index=-1,this.timer=null,this.stopped=!1,this.animating=!1,this._dimension=null,this._position=null,this._size=0,this._resetTo=null,this.events={"resize window":b.throttle(this.calculate,50),"keydown window":"onKeydown","swipeleft element":"next","swipeup element":"next","swiperight element":"prev","swipedown element":"prev","click element .@carousel-tabs a":"onJump","click element .@carousel-next":"next","click element .@carousel-prev":"prev","click element .@carousel-start":"start","click element .@carousel-stop":"stop"},c.stopOnHover&&(this.events["mouseenter element"]="stop",this.events["mouseleave element"]="start"),this.initialize(),this._setupState(),this._buildClones(),this.calculate(),this.start(),this.jump(c.defaultIndex)},{calculate:function(){if("fade"!==this.options.animation){var a,b=this._dimension;this._size=a=this.element[b]()/this.options.itemsToShow;var c=this.items.css(b,a);this.container.css(b,a*c.length)}},doDestroy:function(){this.jump(0),clearInterval(this.timer),this.container.transitionend(function(){b(this).addClass("no-transition").css("left",0).find("li.is-cloned").remove()})},jump:function(a){if(!this.animating){var b=this._getIndex(a),c=b[0],d=b[1];d!==this.index&&(this._updateTabs(d),this._updateItems(c),this._beforeCycle(),"fade"===this.options.animation?this.items.conceal().eq(d).transitionend(this._afterCycle).reveal():this.container.transitionend(this._afterCycle).css(this._position,-(c*this._size)),this.index=d,this.reset(),this.fireEvent("jump",d))}},next:function(){this.jump(this.index+this.options.itemsToCycle)},prev:function(){this.jump(this.index-this.options.itemsToCycle)},reset:function(){this.options.autoCycle&&(clearInterval(this.timer),this.timer=setInterval(this.onCycle,this.options.duration))},start:function(){this.element.removeClass("is-stopped"),this.stopped=!1,this.fireEvent("start")},stop:function(){this.element.addClass("is-stopped"),this.stopped=!0,this.fireEvent("stop")},_afterCycle:function(){this.animating=!1;var a=this.container,b=this._resetTo;null!==b&&(a.addClass("no-transition").css(this._position,-(b*this._size)),this._updateItems(b),this._resetTo=null),setTimeout(function(){a.removeClass("no-transition")},15)},_beforeCycle:function(){this.animating=!0},_buildClones:function(){var a=this.options,b=this.items,c=this.container,d=a.itemsToShow;a.infinite&&(b.slice(0,d).clone().addClass("is-cloned").removeAttr("id").removeAttr("role").appendTo(c),b.slice(-d).clone().addClass("is-cloned").removeAttr("id").removeAttr("role").prependTo(c),this.items=c.find("li"))},_getIndex:function(a){var b,c,d=this.options,e=d.itemsToShow;if(d.infinite){var f=this.items.length,g=f-2*e;a>=g?(this._resetTo=0+e,c=f-e,b=0):-e>=a?(this._resetTo=g,c=0,b=g-e):(this._resetTo=null,b=a,c=a+e)}else{var h=this.element.removeClass("no-next no-prev"),i=this.items.length-e;a>=i?(a=i,d.loop?a==this.index&&this.index===i&&(a=0):h.addClass("no-next")):0>=a&&(a=0,d.loop?a==this.index&&0===this.index&&(a=i):h.addClass("no-prev")),c=b=a}return[c,b]},_setupState:function(){var a=this.options,b=a.animation;a.itemsToCycle>a.itemsToShow&&(a.itemsToCycle=a.itemsToShow),"fade"===b&&(a.itemsToShow=a.itemsToCycle=1,a.infinite=!1),"slide-up"===b?(this._dimension="height",this._position="top"):"slide"===b&&(this._dimension="width",this._position="left")},_updateItems:function(a){this.items.removeClass("is-active").aria("hidden",!0).slice(a,a+this.options.itemsToShow).addClass("is-active").aria("hidden",!1)},_updateTabs:function(a){var c=this.options.itemsToShow,d=this.items.length,e=a+c,f=b([]),g=this.tabs.removeClass("is-active").aria("toggled",!1);g.length&&(this.options.infinite&&(d-=2*c),a>=0?f=f.add(g.slice(a,e)):(f=f.add(g.slice(0,e)),f=f.add(g.slice(a))),e>d&&(f=f.add(g.slice(0,e-d))),f.addClass("is-active").aria("toggled",!1))},onCycle:function(){this.stopped||(this.fireEvent("cycle",this.index),this.options.reverse?this.prev():this.next())},onJump:function(a){a.preventDefault(),this.jump(b(a.currentTarget).data("carousel-index")||0)},onKeydown:function(a){if(b.inArray(a.keyCode,[37,38,39,40])>=0)switch(a.preventDefault(),a.keyCode){case 37:this.prev();break;case 38:this.jump(0);break;case 39:this.next();break;case 40:this.jump(-1)}}},{animation:"slide",duration:5e3,autoCycle:!0,stopOnHover:!0,infinite:!0,loop:!0,reverse:!1,itemsToShow:1,itemsToCycle:1,defaultIndex:0}),f.create("carousel",function(a){return new f.Carousel(this,a)}),f.Drop=f.Component.extend(function(a,c){this.component="Drop",this.version="1.4.0",this.options=this.setOptions(c),this.element=null,this.nodes=b(a),this.node=null,this.events={"clickout document .@drop":"hide","clickout document {selector}":"hide","{mode} document {selector}":"onShow"},this.initialize()},{hide:function(){var a=this.element;a&&a.is(":shown")&&(a.conceal(),this.node.aria("toggled",!1).removeClass("is-active"),this.fireEvent("hide",[a,this.node]))},show:function(a){this.element.reveal(),this.node=a=b(a).aria("toggled",!0).addClass("is-active"),this.fireEvent("show",[this.element,a])},onShow:function(a){a.preventDefault();var c=b(a.currentTarget),d=this.options,e=this.readValue(c,d.getTarget);e&&"#"===e.substr(0,1)&&(d.hideOpened&&this.node&&!this.node.is(c)&&this.hide(),this.element=b(e),this.node=c,this.element.is(":shown")?this.hide():this.show(c))}},{mode:"click",getTarget:"data-drop",hideOpened:!0}),f.create("drop",function(a){return new f.Drop(this,a)},!0),f.Flyout=f.Component.extend(function(a,c,d){if(!c)throw new Error("Flyout URL required to download sitemap JSON");this.component="Flyout",this.version="1.4.0",this.options=d=this.setOptions(d),this.element=null,this.nodes=b(a),this.node=null,this.current=null,this.menus={},this.data=[],this.dataMap={},this.timers={},this.events={},"click"===d.mode?this.events["click document {selector}"]="onShow":(this.events["mouseenter document {selector}"]=["onShow","onEnter"],this.events["mouseleave document {selector}"]="onLeave"),this.initialize(),b.getJSON(c,this.load)},{clearTimer:function(a){clearTimeout(this.timers[a]),delete this.timers[a]},doDestroy:function(){b.each(this.menus,function(a,b){b.remove()}),this.clearTimer("show"),this.clearTimer("hide")},hide:function(){this.node&&this.node.removeClass("is-active"),this.current&&this.isVisible()&&(this.menus[this.current].conceal(),this.fireEvent("hide"),this.current=null)},isVisible:function(){return this.current&&this.menus[this.current]&&(this.element=this.menus[this.current]),this.element&&this.element.is(":shown")},load:function(a,b){if(b=b||0,0===b&&(this.data=a),a.url&&(this.dataMap[a.url]=a),a.children)for(var c=0,d=a.children.length;d>c;c++)this.load(a.children[c],b+1)},position:function(){var c=this.current,d=this.options;if(this.menus[c]){var e=this.menus[c],f=e.outerHeight(),g=this.node.offset(),h=g.left+d.xOffset,i=g.top+d.yOffset+this.node.outerHeight(),j=b(a).height();i>j/2&&(i=g.top-d.yOffset-f),e.css({left:h,top:i}).reveal(),this.fireEvent("show")}},show:function(a){var c=this._getTarget(a);this.current&&c!==this.current&&(this.hide(),this.startTimer("show",this.options.showDelay)),this.node=b(a),this._getMenu()&&(this.node.addClass("is-active"),"click"===this.options.mode&&this.position())},startTimer:function(a,b,c){this.clearTimer(a);var d;d="show"===a?this.position:this.hide,d&&(this.timers[a]=setTimeout(function(){d.apply(this,c||[])}.bind(this),b))},_buildMenu:function(a,c){if(!c.children||!c.children.length)return null;var d,e,f,h,i,j=this.options,k=b(j.template).attr("role","menu").aria("hidden",!0),l=[],m=j.itemLimit;if(j.className&&k.addClass(j.className),a.is("body")?k.addClass("is-root"):k.aria("expanded",!1),m&&c.children.length>m)for(h=0,i=c.children.length;i>h;)l.push(c.children.slice(h,h+=m));else l.push(c.children);for(var n,o,p=0;n=l[p];p++){for(d=b("<ul/>"),h=0,i=n.length;i>h;h++)o=n[h],e=b("<li/>"),o.url?(f=b("<a/>",{text:o.title,href:o.url,role:"menuitem"}),b("<span/>").addClass(o.icon||"caret-right").prependTo(f)):(f=b("<span/>",{text:o.title,role:"presentation"}),e.addClass(g+"flyout-heading")),o.attributes&&f.attr(o.attributes),o.className&&e.addClass(o.className),e.append(f).appendTo(d),o.children&&o.children.length&&(this._buildMenu(e,o),e.addClass("has-children").aria("haspopup",!0).on("mouseenter",this.onPositionChild.bind(this,e)).on("mouseleave",this.onHideChild.bind(this,e)));k.append(d)}return k.appendTo(a),k},_getMenu:function(){var a=this._getTarget();if(this.menus[a])return this.current=a,this.menus[a];if(this.dataMap[a]){var c=this._buildMenu(b("body"),this.dataMap[a]);return c?(c.conceal(),"click"!==this.options.mode&&c.on({mouseenter:function(){this.clearTimer("hide")}.bind(this),mouseleave:function(){this.startTimer("hide",this.options.hideDelay)}.bind(this)}),this.current=a,this.menus[a]=c,this.menus[a]):null}return null},_getTarget:function(a){return a=b(a||this.node),this.readValue(a,this.options.getUrl)||a.attr("href")},onEnter:function(){this.clearTimer("hide"),this.startTimer("show",this.options.showDelay)},onHideChild:function(a){a=b(a),a.removeClass("is-open"),a.children("."+g+"flyout").removeAttr("style").aria({expanded:!1,hidden:!1}),this.fireEvent("hideChild",a)},onLeave:function(){this.clearTimer("show"),this.startTimer("hide",this.options.showDelay)},onPositionChild:function(c){var d=c.children("."+g+"flyout");if(d){d.aria({expanded:!0,hidden:!0});var e=d.children();d.css("width",e.outerWidth()*e.length+"px");var f=b(a),h=f.height()+f.scrollTop(),i=f.width(),j=c.offset().top,k=c.outerHeight(),l=c.offset().left+c.outerWidth(),m=l+d.outerWidth();m>=i?d.addClass("push-left"):d.removeClass("push-left"),j>h/2?d.css("top","-"+(d.outerHeight()-k)+"px"):d.css("top",0),c.addClass("is-open"),this.fireEvent("showChild",c)}},onShow:function(a){if(!f.isTouch){var c=b(a.target),d=this.node&&c[0]===this.node[0];if(this.isVisible()){if(f.isTouch?d&&"a"===this.node.prop("tagName").toLowerCase()||a.preventDefault():a.preventDefault(),"click"===this.options.mode&&this.hide(),d)return}else a.preventDefault();this.show(c)}}},{mode:"hover",getUrl:"href",xOffset:0,yOffset:0,showDelay:350,hideDelay:1e3,itemLimit:15,template:'<div class="flyout"></div>'}),f.create("flyout",function(a,b){return new f.Flyout(this,a,b)},!0),f.Input=f.Component.extend(function(a,c){this.component="Input",this.version="1.4.0",this.element=a=b(a),this.options=c=this.setOptions(c,a),c.checkbox&&a.find(c.checkbox).inputCheckbox(c),c.radio&&a.find(c.radio).inputRadio(c),c.select&&a.find(c.select).inputSelect(c),this.initialize()},{copyClasses:function(a,c){var d=(b(a).attr("class")||"").replace(/\binput\b/,"").trim();d&&b(c).addClass(d)},doDestroy:function(){var a=this.options,c=this.element;"Input"===this.component?(a.checkbox&&c.find(a.checkbox).each(function(){b(this).toolkit("inputCheckbox","destroy")}),a.radio&&c.find(a.radio).each(function(){b(this).toolkit("inputRadio","destroy")}),a.select&&c.find(a.select).each(function(){b(this).toolkit("inputSelect","destroy")})):(this.wrapper.replaceWith(this.input),this.input.removeAttr("style"))},_buildWrapper:function(){var a=this.input,c=b("<div/>").addClass(g+"custom-input").insertBefore(a).append(a);return this.options.copyClasses&&this.copyClasses(a,c),c}},{copyClasses:!0,checkbox:"input:checkbox",radio:"input:radio",select:"select"}),f.InputCheckbox=f.Input.extend(function(a,c){this.component="InputCheckbox",this.version="1.4.0",this.input=a=b(a),this.options=this.setOptions(c,a),this.wrapper=this._buildWrapper(),this.element=b("<label/>").addClass(g+"checkbox").attr("for",a.attr("id")).insertAfter(a),this.initialize()}),f.InputRadio=f.Input.extend(function(a,c){this.component="InputRadio",this.version="1.4.0",this.input=a=b(a),this.options=this.setOptions(c,a),this.wrapper=this._buildWrapper(),this.element=b("<label/>").addClass(g+"radio").attr("for",a.attr("id")).insertAfter(a),this.initialize()}),f.InputSelect=f.Input.extend(function(a,c){var d={};this.component="InputSelect",this.version="1.4.0",this.input=a=b(a),this.multiple=a.prop("multiple"),this.options=c=this.setOptions(c,a),this.multiple&&c.native||(this.wrapper=this._buildWrapper(),this.element=this._buildButton(),this.dropdown=null,this.index=0,d["change input"]="onChange",c.native||(d["blur input"]="hide",d["clickout document .@select-options"]="hide",d["clickout element"]="hide",d["click element"]="onToggle",this.multiple||(d["keydown window"]="onCycle"),this._buildDropdown(),this.input.css("z-index",1)),this.events=d,this.initialize(),this.input.change())},{hide:function(){this.element.removeClass("is-active"),this.dropdown&&this.dropdown.conceal(),this.fireEvent("hide")},show:function(){this.options.hideOpened&&b("."+g+"drop.select-options").each(function(){b(this).siblings("select").toolkit("inputSelect","hide")}),this.element.addClass("is-active"),this.dropdown&&this.dropdown.reveal(),this.fireEvent("show")},_buildButton:function(){var a=b("<div/>").addClass(g+"select").append(b("<div/>").addClass(g+"select-arrow").html(this.options.arrowContent)).append(b("<div/>").addClass(g+"select-label").html(f.messages.loading)).css("min-width",this.input.width()).insertAfter(this.input);return this.multiple&&this.input.css("max-height",a.height()),a},_buildDropdown:function(){var a=this.input,c=this.options,d=this._buildOption,e=b("<div/>").addClass(g+"drop "+g+"drop--down "+g+"select-options").attr("role","listbox").aria("multiselectable",this.multiple),f=b("<ul/>"),h=0,i=this;return this.dropdown=e,a.children().each(function(){var a=b(this);"optgroup"===a.prop("tagName").toLowerCase()?(0===h&&(c.hideFirst=!1),f.append(b("<li/>").addClass(g+"drop-heading").text(a.attr("label"))),a.children().each(function(){var c=b(this);a.prop("disabled")&&c.prop("disabled",!0),c.prop("selected")&&(i.index=h),f.append(d(c,h)),h++})):(a.prop("selected")&&(i.index=h),f.append(d(a,h)),h++)}),c.hideSelected&&!c.multiple&&e.addClass("hide-selected"),c.hideFirst&&e.addClass("hide-first"),this.multiple&&e.addClass("is-multiple"),this.wrapper.append(e.append(f)),e},_buildOption:function(a,c){var d,e=this.input,f=this.dropdown,h=a.prop("selected"),i="is-active",j=b("<li/>"),k=a.text();h&&j.addClass(i),(d=this.readValue(a,this.options.getDescription))&&(k+=' <span class="'+g+'drop-desc">'+d+"</span>");var l=b("<a/>",{html:k,href:"javascript:;",role:"option"}).aria("selected",h);if(this.options.copyClasses&&this.copyClasses(a,j),j.append(l),a.prop("disabled"))return j.addClass("is-disabled"),l.aria("disabled",!0),j;if(this.multiple)l.click(function(){var c=b(this),d=!1;a.prop("selected")?c.parent().removeClass(i):(d=!0,c.parent().addClass(i)),a.prop("selected",d),c.aria("selected",d),e.change()});else{var m=this;l.click(function(){f.find("li").removeClass(i).end().find("a").aria("selected",!1),b(this).aria("selected",!0).parent().addClass(i),m.hide(),m.index=c,e.val(a.val()),e.change()})}return j},_loop:function(a,b,c){var d=this.options.hideFirst;for(a+=b;"undefined"==typeof c[a]||c[a].disabled||0===a&&d;)a+=b,a>=c.length?a=0:0>a&&(a=c.length-1);return a},onChange:function(a){var c=b(a.target),d=c.find("option"),e=this.options,f=[],h=[],i=this;if(d.each(function(){this.selected&&(f.push(this),h.push(i.readValue(this,e.getOptionLabel)||this.textContent))}),this.multiple){var j=this.readValue(c,e.getDefaultLabel),k=e.multipleFormat,l=h.length;if(!h.length&&j)h=j;else if("count"===k)h=e.countMessage.replace("{count}",l).replace("{total}",d.length);else if("list"===k){var m=e.listLimit;h=h.splice(0,m).join(", "),l>m&&(h+=" ...")}}else h=h.join(", ");c.parent().find("."+g+"select-label").text(h),this.fireEvent("change",[c.val(),f])},onCycle:function(a){if(this.dropdown.is(":shown")&&b.inArray(a.keyCode,[38,40,13,27])>=0){a.preventDefault();var c=this.input.find("option"),d=this.dropdown.find("a"),e="is-active",f=this.index;switch(a.keyCode){case 13:case 27:return void this.hide();case 38:f=this._loop(f,-1,c);break;case 40:f=this._loop(f,1,c)}c.prop("selected",!1),c[f].selected=!0,d.parent().removeClass(e),d.eq(f).parent().addClass(e),this.index=f,this.input.change()}},onToggle:function(){this.input.prop("disabled")||(this.dropdown.is(":shown")?this.hide():this.show())}},{"native":f.isTouch,multipleFormat:"count",countMessage:"{count} of {total} selected",listLimit:3,hideOpened:!0,hideFirst:!1,hideSelected:!1,arrowContent:'<span class="caret-down"></span>',getDefaultLabel:"title",getOptionLabel:"title",getDescription:"data-description"}),f.create("input",function(a){return new f.Input(this,a)}),f.create("inputRadio",function(a){return new f.InputRadio(this,a)}),f.create("inputCheckbox",function(a){return new f.InputCheckbox(this,a)}),f.create("inputSelect",function(a){return new f.InputSelect(this,a)}),f.LazyLoad=f.Component.extend(function(c,d){c=b(c),this.component="LazyLoad",this.version="1.5.0",this.options=d=this.setOptions(d,c),this.container="auto"===c.css("overflow")?c:b(a),this.elements=c.find(".lazy-load"),this.element=null,this.loaded=0;var e=b.throttle(this.load,d.throttle);this.events={"scroll container":e,"resize window":e,"ready document":"onReady"},this.initialize()},{doDestroy:function(){this.loadAll()},inViewport:function(c){c=b(c);var d=this.container,e=this.options.threshold,f=d.height(),g=d.width(),h=d.scrollTop(),i=d.scrollLeft(),j=c.offset(),k=j.left,l=j.top;if(d[0]!==a){var m=d.offset();k-=m.left,l-=m.top}return c.is(":visible")&&l>=h-e&&h+f+e>=l&&k>=i-e&&i+g+e>=k},load:function(){return this.loaded>=this.elements.length?void this.shutdown():(this.elements.each(function(a,b){b&&this.inViewport(b)&&this.show(b,a)}.bind(this)),void this.fireEvent("load"))},loadAll:function(){this.elements.each(function(a,b){this.show(b,a)}.bind(this)),this.fireEvent("loadAll"),this.shutdown()},show:function(a,c){a=b(a),a.removeClass("lazy-load"),this.element=a,a.find("img").each(function(){var a,c=b(this);f.isRetina&&(a=c.data("src-retina")),a||(a=c.data("src")),a&&c.attr("src",a)}),this.elements.splice(c,1,null),this.loaded++,this.fireEvent("show",a)},shutdown:function(){this.enabled&&(this.disable(),this.fireEvent("shutdown"))},onReady:function(){this.load(),this.options.forceLoad&&setTimeout(this.loadAll,this.options.delay)}},{forceLoad:!1,delay:1e4,threshold:150,throttle:50}),f.create("lazyLoad",function(a){return new f.LazyLoad(this,a)}),f.Mask=f.Component.extend(function(a,c){this.component="Mask",this.version="1.4.0",this.element=a=b(a),this.options=c=this.setOptions(c,a),a.is("body")||(a.addClass(g+"mask-target"),"static"===a.css("position")&&a.css("position","relative"));var d=g+"mask",e=a.find("> ."+d);e.length||(e=b("<div/>").addClass(d)),this.setMask(e),this.events={},c.selector&&(this.events["click document "+c.selector]="toggle"),this.initialize()},{doDestroy:function(){this.mask.remove(),this.element.removeClass(g+"mask-target").removeClass("is-masked").css("position","")},hide:function(){this.mask.conceal(),this.element.removeClass("is-masked"),this.fireEvent("hide")},setMask:function(a){var c,d=this.options;a.addClass("hide").appendTo(this.element),this.element.is("body")&&a.css("position","fixed"),d.revealOnClick&&a.click(this.hide),this.mask=a,c=a.find("> ."+g+"mask-message"),c.length||(c=b("<div/>").addClass(g+"mask-message").appendTo(a),d.messageContent&&c.html(d.messageContent)),this.message=c},show:function(){this.mask.reveal(),this.element.addClass("is-masked"),this.fireEvent("show")},toggle:function(){this.mask.is(":shown")?this.hide():this.show()}},{selector:"",revealOnClick:!1,messageContent:""}),f.create("mask",function(a){return new f.Mask(this,a)}),f.Matrix=f.Component.extend(function(a,c){this.component="Matrix",this.version="1.5.1",this.element=a=b(a).addClass(g+"matrix"),this.options=c=this.setOptions(c,a),this.items=[],this.matrix=[],this.wrapperWidth=0,this.colWidth=0,this.colHeights=[],this.colCount=0,this.images=[],this.events={"resize window":b.debounce(this.onResize)},this.initialize(),c.defer?this._deferRender():this.refresh()},{append:function(a){b(a).appendTo(this.element).css("opacity",0),this.refresh()},doDestroy:function(){this.element.removeAttr("style"),this.items.removeAttr("style")},prepend:function(a){b(a).prependTo(this.element).css("opacity",0),this.refresh()},refresh:function(){this.items=this.element.find("> li").each(function(){var a=b(this);a.addData("matrix-column-width",a.outerWidth())}),this.render()},remove:function(a){this.items.each(function(){var c=b(this);return c.is(a)?(c.remove(),!1):!0}),this.refresh()},render:function(){this._calculateColumns();var a=this.element,b=this.items;b.length?this.colCount<=1?(a.removeAttr("style").addClass("no-columns"),b.removeAttr("style")):(a.removeClass("no-columns"),this._organizeItems(),this._positionItems()):a.removeAttr("style"),this.fireEvent("render")},_calculateColumns:function(){var a,b=this.element.outerWidth(),c=this.options.width,d=this.options.gutter,e=Math.max(Math.floor(b/c),1),f=e*(c+d)-d;e>1&&(f>b?(a=f-b,c-=a/e):b>f&&(a=b-f,c+=a/e)),this.wrapperWidth=b,this.colWidth=c,this.colCount=e},_deferRender:function(){var a=[];this.images=this.element.find("img").each(function(c,d){var e=d.src,f=b.Deferred();d.onload=f.resolve,d.onerror=d.onabort=f.reject,d.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",d.src=e,a.push(f.promise())}),b.when.apply(b,a).always(this.refresh)},_organizeItems:function(){var a,b,c,d=this.items.length;this.matrix=[];for(var e=0;d>e;e++)if(a=this.items.eq(e),c=a.data("matrix-column-width"),b=Math.max(Math.round(c/this.colWidth),1),b>this.colCount&&(b=this.colCount),this.matrix.push({item:a,span:b}),b>1)for(var f=1;b>f;f++)this.matrix&&this.matrix.push({item:a,span:!1})},_positionItems:function(){var a,b,c,d,e,f,g=this.options.gutter,h=this.matrix,i=this.options.rtl?"right":"left",j=[],k=0,l=0,m={margin:0,position:"absolute"};for(c=0;c<this.colCount;c++)j.push(0);for(c=0,d=h.length;d>c;c++){for(a=h[c],b=a.span,l=-1,e=0;e<this.colCount;e++)(-1===l||j[e]<l)&&(l=j[e],k=e);if((k>=this.colCount||b+k>this.colCount)&&(k=0),b){for(f=0,e=0;b>e;e++)j[k+e]>f&&(f=j[k+e]);for(m.top=f,m[i]=(this.colWidth+g)*k,m.width=(this.colWidth+g)*b-g,a.item.css(m).reveal(),e=0;b>e;e++)j[k+e]=a.item.outerHeight()+g+f}this.colHeights[k]=j[k],k++}this.element.css("height",Math.max.apply(Math,j))},onResize:function(){this.refresh()}},{width:200,gutter:20,rtl:!1,defer:!0}),f.create("matrix",function(a){return new f.Matrix(this,a)}),f.Modal=f.Component.extend(function(a,c){var d;this.component="Modal",this.version="1.4.0",this.options=c=this.setOptions(c),this.element=d=this.createElement().attr("role","dialog").aria("labelledby",this.id("title")).aria("describedby",this.id("content")),c.fullScreen&&d.addClass("is-fullscreen"),this.nodes=b(a),this.node=null,this.blackout=c.blackout?f.Blackout.factory():null,c.blackout&&c.stopScroll&&this.blackout.element.on("hide.toolkit.blackout",function(a,c){c&&b("body").removeClass("no-scroll")}),this.events={"keydown window":"onKeydown","clickout element":"onHide","clickout document {selector}":"onHide","click document {selector}":"onShow","click element .@modal-hide":"onHide","click element .@modal-submit":"onSubmit"},this.initialize()},{hide:function(){this.element.conceal(),this.blackout&&this.blackout.hide(),this.fireEvent("hide")},position:function(c){if(c!==!0){this.blackout&&this.blackout.hideLoader();var d=this.element.find("."+g+"modal-inner");d.html(c),this.fireEvent("load",c),this.element.reveal(),this.options.fullScreen&&d.css("min-height",b(a).height()),this.fireEvent("show")}},show:function(a,c){var d=this.options,e=d.ajax;c?e=!1:a&&(this.node=a=b(a),e=this.readOption(a,"ajax"),c=this.readValue(a,this.readOption(a,"getContent"))||a.attr("href"),c&&c.match(/^#[a-z0-9_\-\.:]+$/i)&&(c=b(c).html(),e=!1)),c&&(this.blackout&&!this.element.is(":shown")&&this.blackout.show(),d.stopScroll&&b("body").addClass("no-scroll"),e?this.cache[c]?this.position(this.cache[c]):this.requestData(c):this.position(c))},submit:function(){var b=this.element.find("form:first");if(b){this.fireEvent("submit",[b]);var c={url:b.attr("action"),type:(b.attr("method")||"post").toUpperCase()};a.FormData?(c.processData=!1,c.contentType=!1,c.data=new FormData(b[0])):c.data=b.serialize(),this.requestData(c)}},onHide:function(a){a.preventDefault();var b=this.element;b.is(":shown")&&!b.hasClass("is-loading")&&this.hide()},onKeydown:function(a){27===a.keyCode&&this.element.is(":shown")&&this.hide()},onShow:function(a){a.preventDefault(),this.show(a.currentTarget)},onSubmit:function(a){a.preventDefault(),this.submit()}},{animation:"fade",ajax:!0,draggable:!1,blackout:!0,fullScreen:!1,stopScroll:!0,getContent:"data-modal",template:'<div class="modal"><div class="modal-outer"><div class="modal-inner"></div><button class="modal-close modal-hide"><span class="x"></span></button></div></div>'}),f.create("modal",function(a){return new f.Modal(this,a)},!0),f.OffCanvas=f.Component.extend(function(a,c){this.component="OffCanvas",this.version="1.5.0",this.element=a=b(a).addClass(g+"off-canvas").attr("role","complementary").conceal(),this.options=c=this.setOptions(c,a);var d={},e=c.animation;f.isTouch&&"squish"===e&&(c.animation=e="push"),"on-top"!==e&&"squish"!==e&&(c.hideOthers=!0),this.container=a.parents("."+g+"canvas").addClass(e),this.primary=a.siblings("."+g+"on-canvas").attr("role","main"),this.secondary=a.siblings("."+g+"off-canvas"),this.side=a.hasClass(g+"off-canvas--left")?"left":"right",this.opposite="left"===this.side?"right":"left",d["ready document"]="onReady",d["resize window"]="onResize","left"===this.side?(d["swipeleft element"]="hide",d["swiperight container"]="onSwipe"):(d["swipeleft container"]="onSwipe",d["swiperight element"]="hide"),c.selector&&(d["click document "+c.selector]="toggle"),this.events=d,this.initialize()},{hide:function(){this.container.removeClass("move-"+this.opposite),this.element.conceal().removeClass("is-expanded").aria("expanded",!1),this.options.stopScroll&&b("body").removeClass("no-scroll"),this.fireEvent("hide")},show:function(){var a=this.options;a.hideOthers&&this.secondary.each(function(){var a=b(this);a.hasClass("is-expanded")&&a.toolkit("offCanvas","hide")}),this.container.addClass("move-"+this.opposite),this.element.reveal().addClass("is-expanded").aria("expanded",!0),a.stopScroll&&b("body").addClass("no-scroll"),this.fireEvent("show")},toggle:function(){this.element.hasClass("is-expanded")?this.hide():this.show()},onReady:function(){if(this.options.openOnLoad){var a=this.element,b=this.primary,c="no-transition";a.addClass(c),b.addClass(c),this.show(),setTimeout(function(){a.removeClass(c),b.removeClass(c)},15)}},onResize:function(){this.fireEvent("resize")},onSwipe:function(a){a.preventDefault();var c=b(a.target),d="."+g+"off-canvas";c.is(d)||c.parents(d).length||this.show()}},{selector:"",animation:"push",openOnLoad:!1,hideOthers:!0,stopScroll:!0}),f.create("offCanvas",function(a){return new f.OffCanvas(this,a)}),f.Pin=f.Component.extend(function(a,c){this.component="Pin",this.version="1.5.0",this.element=a=b(a),this.options=c=this.setOptions(c,a),a.attr("role","complementary").addClass(g+"pin").addClass(c.animation),this.elementHeight=null,this.elementTop=parseInt(a.css("top"),10),this.parentHeight=null,this.parentTop=null,this.viewport=null,this.active=!0;var d=c.throttle;this.events={"scroll window":b.throttle(this.onScroll,d),"resize window":b.throttle(this.onResize,d),"ready document":"onResize"},this.initialize()},{calculate:function(){var c=b(a),d=this.options,e=d.context?this.element.parents(d.context):this.element.parent();this.viewport={width:c.width(),height:c.height()},this.elementHeight=this.element.outerHeight(!0),this.parentHeight=e.height(),this.parentTop=e.offset().top,this.active=d.lock&&this.elementHeight>=this.viewport.height?!1:this.element.is(":visible")&&this.parentHeight>this.elementHeight},doDestroy:function(){this.active=!1,setTimeout(function(){this.element.removeAttr("style").removeClass("is-pinned")}.bind(this),15)},pin:function(){var c=this.options;if(c.calculate&&this.calculate(),this.active){var d=c.fixed,e=this.elementHeight,f=this.elementTop,g=this.parentHeight,h=this.parentTop,i=b(a).scrollTop(),j={},k=c.xOffset,l=0;if(h>i)return void this.element.removeAttr("style").removeClass("is-pinned");var m=i+e,n=g+h;d?m>=n?(l="auto",j.position="absolute",j.bottom=0):(l=c.yOffset,j.position="fixed",j.bottom="auto"):(j.position="absolute",l+=m>=n?g-e:i-h+c.yOffset,f&&f>l&&(l=f)),j[c.location]=k,j.top=l,this.element.css(j).addClass("is-pinned")}},onResize:function(){this.calculate(),this.pin(),this.fireEvent("resize")},onScroll:function(){this.pin(),this.fireEvent("scroll")}},{location:"right",xOffset:0,yOffset:0,throttle:50,fixed:!1,calculate:!1,lock:!0}),f.create("pin",function(a){return new f.Pin(this,a)}),f.Tooltip=f.Component.extend(function(a,c){var d;this.component="Tooltip",this.version="1.5.0",this.options=c=this.setOptions(c),this.element=d=this.createElement().attr("role","tooltip").removeClass(c.className),"title"===c.getTitle&&(c.getTitle="data-tooltip-title"),this.elementHead=d.find("."+g+"tooltip-head"),this.elementBody=d.find("."+g+"tooltip-body"),this.nodes=b(a).each(function(a,c){b(c).attr("data-tooltip-title",b(c).attr("title")).removeAttr("title")}),this.node=null,this.events={"{mode} document {selector}":"onShow"},"click"===c.mode?(this.events["clickout element"]="hide",this.events["clickout document {selector}"]="hide"):this.events["mouseleave document {selector}"]="hide",this.initialize()},{hide:function(){var a=this.options,b=this.element,c=b.data("new-position")||this.runtime.position||a.position,d=this.runtime.className||a.className;this.runtime={},b.removeClass(c).removeClass(d).removeData("new-position").conceal(),this.node&&this.node.removeAttr("aria-describedby"),this.fireEvent("hide")},position:function(a,c){var d=b.isEmptyObject(this.runtime)?this.options:this.runtime;if(a!==!0)if(this.element.addClass(d.position).addClass(d.className),this.node&&this.node.aria("describedby",this.id()),c=c||this.readValue(this.node,d.getTitle),c&&d.showTitle?this.elementHead.html(c).show():this.elementHead.hide(),a?this.elementBody.html(a).show():this.elementBody.hide(),this.fireEvent("load",a),d.follow){var e=this.onFollow;this.node.off("mousemove",e).on("mousemove",e),this.fireEvent("show")}else this.element.positionTo(d.position,this.node,{left:d.xOffset,top:d.yOffset}),setTimeout(function(){this.element.reveal(),this.fireEvent("show")}.bind(this),d.delay||0)},show:function(a,c,d){var e;a?(this.node=a=b(a),this.runtime=e=this.inheritOptions(this.options,a),c=c||this.readValue(a,e.getContent)):this.runtime=e=this.options,c&&(e.ajax?this.cache[c]?this.position(this.cache[c],d):(e.showLoading&&this.position(f.messages.loading),this.requestData(c)):(c.match(/^#[a-z0-9_\-\.:]+$/i)&&(c=b(c).html()),this.position(c,d)))},onFollow:function(a){a.preventDefault();var b=this.runtime;this.element.positionTo(b.position,a,{left:b.xOffset,top:b.yOffset},!0).reveal()},onShow:function(a){var c=b(a.currentTarget),d=this.node&&this.node.is(c);if(this.element.is(":shown")){if(f.isTouch?d&&"a"===this.node.prop("tagName").toLowerCase()||a.preventDefault():a.preventDefault(),"click"===this.options.mode&&this.hide(),d)return}else a.preventDefault();this.show(c)}},{mode:"hover",animation:"fade",ajax:!1,follow:!1,position:"top-center",showLoading:!0,showTitle:!0,getTitle:"title",getContent:"data-tooltip",mouseThrottle:50,xOffset:0,yOffset:0,delay:0,template:'<div class="tooltip"><div class="tooltip-inner"><div class="tooltip-head"></div><div class="tooltip-body"></div></div><div class="tooltip-arrow"></div></div>'}),f.create("tooltip",function(a){return new f.Tooltip(this,a)},!0),f.Popover=f.Tooltip.extend(function(a,c){var d;this.component="Popover",this.version="1.5.0",this.options=c=this.setOptions(c),this.element=d=this.createElement().attr("role","tooltip").removeClass(c.className),c.mode="click","title"===c.getTitle&&(c.getTitle="data-popover-title"),this.elementHead=d.find("."+g+"popover-head"),this.elementBody=d.find("."+g+"popover-body"),this.nodes=b(a).each(function(a,c){b(c).attr("data-popover-title",b(c).attr("title")).removeAttr("title")}),this.node=null,this.events={"clickout element":"hide","clickout document {selector}":"hide","click document {selector}":"onShow"},this.initialize()},{},{getContent:"data-popover",template:'<div class="popover"><div class="popover-inner"><div class="popover-head"></div><div class="popover-body"></div></div><div class="popover-arrow"></div></div>'}),f.create("popover",function(a){return new f.Popover(this,a)},!0),f.Showcase=f.Component.extend(function(a,c){var d;this.component="Showcase",this.version="1.5.0",this.options=c=this.setOptions(c),this.element=d=this.createElement(),this.nodes=b(a),this.items=d.find("."+g+"showcase-items"),this.tabs=d.find("."+g+"showcase-tabs"),this.caption=d.find("."+g+"showcase-caption"),this.data=[],this.index=-1,this.blackout=c.blackout?f.Blackout.factory():null,this.animating=!1,this.events={"clickout element":"onHide","clickout document {selector}":"onHide","swipeleft element":"next","swiperight element":"prev","keydown window":"onKeydown","click document {selector}":"onShow","click element .@showcase-hide":"onHide","click element .@showcase-next":"next","click element .@showcase-prev":"prev","click element .@showcase-tabs a":"onJump"},this.events[f.transitionEnd+" element .showcase-items"]=function(a){a.stopPropagation()},this.initialize()},{hide:function(){this.blackout&&this.blackout.hide(),this.options.stopScroll&&b("body").removeClass("no-scroll"),this.element.conceal().removeClass("is-single"),this.items.removeAttr("style").children("li").conceal(),this.fireEvent("hide")},jump:function(a){if(!this.animating&&(a=b.bound(a,this.data.length),a!==this.index)){var c=this,d=this.element,e=this.caption,g=this.items,h=g.children("li"),i=h.eq(a),j=this.data,k=j[a],l=b.Deferred();if(this.tabs.find("a").removeClass("is-active").eq(a).addClass("is-active"),h.conceal(),e.conceal(),d.addClass("is-loading").aria("busy",!0),this.animating=!0,l.always(function(a,b){g.transitionend(function(){e.html(k.title).reveal(),i.reveal(),c.position(),c.animating=!1}),c._resize(a,b),d.removeClass("is-loading").aria("busy",!1),i.data("width",a).data("height",b)}),l.fail(function(){d.addClass("has-failed"),i.html(f.messages.error)}),i.data("width"))l.resolve(i.data("width"),i.data("height"));else{var m=new Image;m.src=k.image,m.onerror=function(){l.reject(150,150)},m.onload=function(){l.resolve(this.width,this.height),i.append(m)}}this.index=a,this.fireEvent("jump",a)}},next:function(){this.jump(this.index+1)},position:function(){this.blackout&&this.blackout.hideLoader(),this.element.reveal(),this.fireEvent("show")},prev:function(){this.jump(this.index-1)},show:function(a){this.node=a=b(a),this.index=-1,this.element.addClass("is-loading").aria("busy",!0);var c=this.inheritOptions(this.options,a),d=this.readValue,e=d(a,c.getCategory),f=[],g=0;if(e)for(var h,i=0,j=0;h=this.nodes[i];i++)d(h,c.getCategory)===e&&(a.is(h)&&(g=j),f.push({title:d(h,c.getTitle),category:e,image:d(h,c.getImage)}),j++);else f.push({title:d(a,c.getTitle),category:e,image:d(a,c.getImage)});this.blackout&&this.blackout.show(),c.stopScroll&&b("body").addClass("no-scroll"),this._buildItems(f),this.jump(g)},_buildItems:function(a){this.data=a,this.items.empty(),this.tabs.empty();for(var c,d,e,f=0;e=a[f];f++)c=b("<li/>"),c.appendTo(this.items),d=b("<a/>").attr("href","javascript:;").data("index",f),c=b("<li/>"),c.appendTo(this.tabs).append(d);a.length<=1&&this.element.addClass("is-single"),this.fireEvent("load",a)},_resize:function(c,d){var e,f,g=2*this.options.gutter,h=b(a).width()-g,i=b(a).height()-g;c>h&&(e=c/d,f=c-h,c=h,d-=Math.round(f/e)),d>i&&(e=d/c,f=d-i,c-=Math.round(f/e),d=i),this.items.css({width:c,height:d})},onHide:function(a){a.preventDefault();var b=this.element;b.is(":shown")&&!b.hasClass("is-loading")&&this.hide()},onJump:function(a){a.preventDefault(),this.jump(b(a.target).data("index")||0)},onKeydown:function(a){if(this.element.is(":shown"))switch(b.inArray(a.keyCode,[37,38,39,40])>=0&&a.preventDefault(),a.keyCode){case 27:this.hide();break;case 37:this.prev();break;case 38:this.jump(0);break;case 39:this.next();break;case 40:this.jump(-1)}},onShow:function(a){a.preventDefault(),this.show(a.currentTarget)}},{blackout:!0,stopScroll:!0,gutter:50,getCategory:"data-showcase",getImage:"href",getTitle:"title",template:'<div class="showcase"><div class="showcase-inner"><ul class="showcase-items"></ul><ol class="showcase-tabs bullets"></ol><button class="showcase-prev"><span class="arrow-left"></span></button><button class="showcase-next"><span class="arrow-right"></span></button></div><button class="showcase-close showcase-hide"><span class="x"></span></button><div class="showcase-caption"></div></div>'}),f.create("showcase",function(a){return new f.Showcase(this,a)},!0),f.Stalker=f.Component.extend(function(c,d){if(this.component="Stalker",this.version="1.4.0",this.element=c=b(c).addClass(g+"stalker"),this.options=d=this.setOptions(d),!d.target||!d.marker)throw new Error("A marker and target is required");this.container="auto"===c.css("overflow")?c:b(a),this.targets=[],this.markers=[],this.offsets=[],this.events={"scroll container":b.throttle(this.onScroll,d.throttle),"ready document":"onScroll"},this.initialize(),this.refresh()},{activate:function(a){this._stalk(a,"activate")},deactivate:function(a){this._stalk(a,"deactivate")},doDestroy:function(){var a=this.targets,b=this.markers;a.removeClass(g+"stalker-target"),b.removeClass(g+"stalker-marker"),this.options.applyToParent?(a.parent().removeClass("is-active"),b.parent().removeClass("is-marked")):(a.removeClass("is-active"),b.removeClass("is-marked"))},refresh:function(){var c,d=this.container.is(a),e=this.element.offset().top,f=[];"auto"!==this.element.css("overflow")||this.element.is("body")||(this.element[0].scrollTop=0),this.targets=b(this.options.target).addClass(g+"stalker-target"),this.markers=b(this.options.marker).addClass(g+"stalker-marker").each(function(a,g){c=b(g).offset(),d||(c.top-=e),f.push(c)}),this.offsets=f},_stalk:function(a,c){if(a=b(a),"activate"!==c||!a.hasClass("is-stalked")){var d=this.options,e=d.targetBy,f=d.markBy,g="activate"===c?"addClass":"removeClass",h=this.targets.filter(function(){return b(this).attr(e).replace("#","")===a.attr(f)});a[g]("is-stalked"),d.applyToParent?h.parent()[g]("is-active"):h[g]("is-active"),this.fireEvent(c,[a,h])}},onScroll:function(){var a=this.container.scrollTop(),c=this.offsets,d=this.options.onlyWithin,e=this.options.threshold;this.markers.each(function(f,g){g=b(g);var h=c[f],i=h.top-e,j=h.top+g.height()+e;d&&a>=i&&j>=a||!d&&a>=i?this.activate(g):this.deactivate(g)}.bind(this)),this.fireEvent("scroll")}},{target:"",targetBy:"href",marker:"",markBy:"id",threshold:50,throttle:50,onlyWithin:!0,applyToParent:!0}),f.create("stalker",function(a){return new f.Stalker(this,a)}),f.Tabs=f.Component.extend(function(a,c){var d,e,f=this;this.component="Tabs",this.version="1.4.0",this.element=a=b(a),this.options=c=this.setOptions(c,a),c.cookie||(c.cookie=a.attr("id")),this.sections=d=a.find("."+g+"tabs-section").each(function(a,c){c=b(c),c.attr("role","tabpanel").attr("id",c.attr("id")||f.id("section",a)).aria("labelledby",f.id("tab",a)).conceal()}),this.nav=a.find("."+g+"tabs-nav").attr("role","tablist"),this.tabs=e=this.nav.find("a").each(function(a){b(this).data("index",a).attr({role:"tab",id:f.id("tab",a)}).aria({controls:d.eq(a).attr("id"),selected:!1,expanded:!1}).removeClass("is-active")}),this.index=0,this.events={"{mode} element .@tabs-nav a":"onShow"},"click"!==c.mode&&c.preventDefault&&(this.events["click element .@tabs-nav a"]=function(a){a.preventDefault()}),this.initialize();var h=c.defaultIndex;c.persistState&&c.cookie&&(h=b.cookie("toolkit.tabs."+c.cookie)),!h&&c.loadFragment&&location.hash&&(h=e.filter(function(){return b(this).attr("href")===location.hash}).eq(0).data("index")),h&&e[h]||(h=c.defaultIndex),this.jump(h)},{doDestroy:function(){this.sections.eq(this.index).reveal()},hide:function(){this.sections.conceal(),this.fireEvent("hide",this.node)},jump:function(a){this.show(this.tabs[b.bound(a,this.tabs.length)])},show:function(a){a=b(a);var c=a.data("index"),d=this.sections.eq(c),e=this.options,g=this.readOption(a,"ajax"),h=this.readValue(a,this.readOption(a,"getUrl"));g&&h&&"#"!==h.substr(0,1)&&!this.cache[h]&&this.requestData(h,function(){d.html(f.messages.loading).addClass("is-loading").aria("busy",!0)},function(a){e.cache&&(this.cache[h]=!0),this.fireEvent("load",a),d.html(a).removeClass("is-loading").aria("busy",!1)},function(){d.html(f.messages.error).removeClass("is-loading").addClass("has-failed").aria("busy",!1)}),this.tabs.aria("toggled",!1).parent().removeClass("is-active"),c===this.index&&e.collapsible?d.is(":shown")?d.conceal():(a.aria("toggled",!0).parent().addClass("is-active"),d.reveal()):(this.hide(),a.aria("toggled",!0).parent().addClass("is-active"),d.reveal()),e.persistState&&b.cookie("toolkit.tabs."+e.cookie,c,{expires:e.cookieDuration}),this.index=c,this.node=a,this.fireEvent("show",a)},onShow:function(a){(this.options.preventDefault||this.options.ajax&&"#"!==a.currentTarget.getAttribute("href").substr(0,1))&&a.preventDefault(),this.show(a.currentTarget)}},{mode:"click",ajax:!0,collapsible:!1,defaultIndex:0,persistState:!1,preventDefault:!0,loadFragment:!0,cookie:null,cookieDuration:30,getUrl:"href"}),f.create("tabs",function(a){return new f.Tabs(this,a)}),f.Toast=f.Component.extend(function(a,b){this.component="Toast",this.version="1.5.0",this.options=b=this.setOptions(b),this.element=this.createElement().addClass(b.position).removeClass(b.animation).attr("role","log").aria({relevant:"additions",hidden:"false"}).appendTo(a).reveal(),this.initialize()},{create:function(a,c){c=b.extend({},this.options,c||{});var d=this,e=b("<div/>").addClass(g+"toast").addClass(c.animation).attr("role","note").html(a).conceal().prependTo(this.element);this.fireEvent("create",e),setTimeout(function(){d.show(e)},15),c.duration&&setTimeout(function(){d.hide(e)},c.duration+15)},hide:function(a){a=b(a),this.fireEvent("hide",a),a.transitionend(function(){b(this).remove()}).conceal()},show:function(a){a=b(a),a.reveal(),this.fireEvent("show",a)}},{position:"bottom-left",animation:"slide-up",duration:5e3,template:'<aside class="toasts"></aside>'}),f.create("toast",function(a){return new f.Toast(this,a)}),f.TypeAhead=f.Component.extend(function(a,c){if(a=b(a),"input"!==a.prop("tagName").toLowerCase())throw new Error("TypeAhead must be initialized on an input field");var d=this;if(this.component="TypeAhead",this.version="1.4.0",this.options=c=this.setOptions(c,a),this.element=this.createElement().attr("role","listbox").aria("multiselectable",!1),this.input=a,this.shadow=null,this.index=-1,this.items=[],this.term="",this.timer=null,this.cache={},b.each({sorter:"sort",matcher:"match",builder:"build"},function(a,e){if(c[a]!==!1){var f;f=null===c[a]||"function"!==b.type(c[a])?d[e]:c[a],c[a]=f.bind(d)}}),c.prefetch&&"string"===b.type(c.source)){var e=c.source;b.getJSON(e,c.query,function(a){d.cache[e]=a})}c.shadow&&(this.wrapper=b("<div/>").addClass(g+"type-ahead-shadow"),this.shadow=this.input.clone().addClass("is-shadow").removeAttr("id").prop("readonly",!0).aria("readonly",!0),this.input.addClass("not-shadow").replaceWith(this.wrapper),this.wrapper.append(this.shadow).append(this.input)),a.attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off",spellcheck:"false",role:"combobox"}).aria({autocomplete:"list",owns:this.element.attr("id"),expanded:!1}),this.events={"keyup input":"onLookup","keydown input":"onCycle","clickout element":"hide"},this.initialize()},{build:function(a){var c=b("<a/>",{href:"javascript:;",role:"option","aria-selected":"false"});return c.append(b("<span/>",{"class":g+"type-ahead-title",html:this.highlight(a.title)})),a.description&&c.append(b("<span/>",{"class":g+"type-ahead-desc",html:a.description})),c},doDestroy:function(){this.shadow&&(this.shadow.parent().replaceWith(this.input),this.input.removeClass("not-shadow"))},hide:function(){this.shadow&&this.shadow.val(""),this.input.aria("expanded",!1),this.element.conceal(),this.fireEvent("hide")},highlight:function(a){for(var b,c=this.term.replace(/[\-\[\]\{\}()*+?.,\\^$|#]/g,"\\$&").split(" "),d=function(a){return'<mark class="'+g+'type-ahead-highlight">'+a+"</mark>"},e=0;b=c[e];e++)a=a.replace(new RegExp(b,"ig"),d);return a},lookup:function(a){this.term=a,this.timer=setTimeout(this.onFind,this.options.throttle)},match:function(a,b){return a.toLowerCase().indexOf(b.toLowerCase())>=0},position:function(){if(!this.items.length)return void this.hide();var a=this.input.offset();this.element.css({left:a.left,top:a.top+this.input.outerHeight()}).reveal(),this.input.aria("expanded",!0),this.fireEvent("show")},rewind:function(){this.index=-1,this.element.find("li").removeClass("is-active")},select:function(a,b){this.index=a;var c=this.element.find("li");if(c.removeClass("is-active").find("a").aria("selected",!1),a>=0){if(this.items[a]){var d=this.items[a];c.eq(a).addClass("is-active").find("a").aria("selected",!0),this.input.val(d.title),this.fireEvent(b||"select",[d,a])}}else this.input.val(this.term),this.fireEvent("reset")},sort:function(a){return a.sort(function(a,b){return a.title.localeCompare(b.title)})},source:function(a){if(!this.term.length||!a.length)return void this.hide();var c,d=this.options,e=this.term,f={_empty_:[]},h=b("<ul/>");this.items=[],this.index=-1,"function"===b.type(d.sorter)&&(a=d.sorter(a)),"function"===b.type(d.matcher)&&(a=a.filter(function(a){return d.matcher(a.title,e)}));for(var i=0;c=a[i];i++)c.category?(f[c.category]||(f[c.category]=[]),f[c.category].push(c)):f._empty_.push(c);var j=[],k=0;b.each(f,function(a,e){var f=[];"_empty_"!==a&&(j.push(null),f.push(b("<li/>").addClass(g+"type-ahead-heading").append(b("<span/>",{text:a}))));for(var i,l=0;(c=e[l])&&!(k>=d.itemLimit);l++)i=d.builder(c),i.on({mouseover:this.rewind,click:b.proxy(this.onSelect,this,j.length)}),f.push(b("<li/>").append(i)),j.push(c),k++;h.append(f)}.bind(this)),this.element.empty().append(h),this.items=j,this.cache[e.toLowerCase()]=j.filter(function(a){return null!==a}),this.fireEvent("load"),this._shadow(),this.position()},_shadow:function(){if(this.shadow){var a=this.input.val(),b=a.toLowerCase(),c="";if(this.cache[b]&&this.cache[b][0]){var d=this.cache[b][0].title;0===d.toLowerCase().indexOf(b)&&(c=a+d.substr(a.length,d.length-a.length))}this.shadow.val(c)}},onCycle:function(a){var b=this.items,c=Math.min(this.options.itemLimit,Math.max(0,b.length)),d="cycle";if(c&&this.element.is(":shown")){switch(a.keyCode){case 38:this.index-=b[this.index-1]?1:2,this.index<0&&(this.index=c);break;case 40:this.index+=b[this.index+1]?1:2,this.index>=c&&(this.index=-1);break;case 9:a.preventDefault();for(var e=0;!this.items[e];)e++;d="select",this.index=e,this.hide();break;case 13:a.preventDefault(),d="select",this.hide();break;case 27:this.index=-1,this.hide();break;default:return}this.shadow&&this.shadow.val(""),this.select(this.index,d)}},onFind:function(){var a=this.term,c=this.options,d=b.type(c.source);if(this.cache[a.toLowerCase()])this.source(this.cache[a.toLowerCase()]);else if("string"===d){var e=c.source,f=this.cache[e];if(f)this.source(f);else{var g=c.query;g.term=a,b.getJSON(e,g,this.source)}}else if("array"===d)this.source(c.source);else{if("function"!==d)throw new Error("Invalid TypeAhead source type");var h=c.source.call(this);h&&this.source(h)}},onLookup:function(a){if(!(b.inArray(a.keyCode,[38,40,27,9,13])>=0)){clearTimeout(this.timer);var c=this.input.val().trim();c.length<this.options.minLength?(this.fireEvent("reset"),this.hide()):(this._shadow(),this.lookup(c))}},onSelect:function(a){this.select(a),this.hide()}},{source:[],minLength:1,itemLimit:15,throttle:250,prefetch:!1,shadow:!1,query:{},template:'<div class="type-ahead"></div>',sorter:null,matcher:null,builder:null}),f.create("typeAhead",function(a){return new f.TypeAhead(this,a)})}(window,jQuery);